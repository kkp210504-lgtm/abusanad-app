<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ø£Ø¨Ùˆ Ø³Ù†Ø¯ Ø§Ù„Ø¹Ù…Ø±ÙŠ ğŸ’¼</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#2c5364">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap');
        * { box-sizing: border-box; }
        body {
            font-family: "Tajawal", sans-serif;
            background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
            color: #fff; margin: 0; padding: 0;
            direction: rtl; min-height: 100vh;
        }
        header {
            background: rgba(255,255,255,0.15);
            backdrop-filter: blur(10px);
            text-align: center; padding: 15px;
            font-size: 1.8em; font-weight: bold;
            box-shadow: 0 2px 15px rgba(0,0,0,0.3);
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }
        nav {
            display: flex; justify-content: space-around;
            background: rgba(255,255,255,0.05);
            padding: 10px 0; position: sticky;
            top: 0; z-index: 10; backdrop-filter: blur(8px);
        }
        nav button {
            background: rgba(255,255,255,0.12);
            border: 1px solid rgba(255,255,255,0.2);
            color: white; padding: 10px 16px;
            border-radius: 14px; font-size: 1em;
            cursor: pointer; transition: 0.3s;
        }
        nav button:hover, nav button.active {
            background: rgba(255,255,255,0.3);
            transform: scale(1.05);
        }
        section { display: none; padding: 25px; animation: fadeIn 0.4s ease-in-out; }
        section.active { display: block; }
        h2 { border-right: 5px solid #00c6ff; padding-right: 10px; margin-bottom: 15px; }
        .card {
            background: rgba(255,255,255,0.1);
            border-radius: 15px; padding: 15px;
            box-shadow: 0 0 20px rgba(0,0,0,0.2);
            margin-bottom: 20px;
        }
        button {
            background: linear-gradient(135deg, #00c6ff, #0072ff);
            border: none; color: white; border-radius: 10px;
            padding: 10px 18px; margin-top: 10px;
            cursor: pointer; transition: 0.3s;
        }
        button:hover { transform: scale(1.05); background: linear-gradient(135deg, #0072ff, #00c6ff); }
        table {
            width: 100%; border-collapse: collapse;
            background: rgba(255,255,255,0.1);
            border-radius: 15px; overflow: hidden;
            margin-top: 15px;
        }
        th, td { padding: 10px; text-align: center; }
        th { background: rgba(255,255,255,0.15); font-weight: bold; }
        tr:nth-child(even) { background: rgba(255,255,255,0.05); }
        input, select {
            border: none; border-radius: 10px; padding: 10px;
            font-size: 1em; width: 100%; margin: 5px 0;
            background: rgba(255,255,255,0.1); color: white;
            outline: none;
        }
        .form-row { display: flex; gap: 10px; }
        .form-row > * { flex: 1; }
        .transfer-card {
            background: rgba(255,255,255,0.1);
            border-radius: 15px; padding: 20px;
            margin-bottom: 15px; border-left: 4px solid #00c6ff;
        }
        .modal {
            display: none; position: fixed; top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0,0,0,0.7); z-index: 100;
            justify-content: center; align-items: center;
        }
        .modal-content {
            background: linear-gradient(135deg, #0f2027, #203a43);
            padding: 25px; border-radius: 15px;
            width: 90%; max-width: 500px;
            box-shadow: 0 0 30px rgba(0,0,0,0.5);
        }
        @media (max-width: 768px) {
            nav { flex-wrap: wrap; }
            nav button { margin: 5px; flex: 1; min-width: 120px; }
            table { font-size: 0.85em; }
            th, td { padding: 8px 5px; }
        }
    </style>
</head>
<body>
    <header>ğŸ’¼ Ø£Ø¨Ùˆ Ø³Ù†Ø¯ Ø§Ù„Ø¹Ù…Ø±ÙŠ</header>
    <nav>
        <button onclick="showSection('home')" class="active">ğŸ  Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
        <button onclick="showSection('customers')">ğŸ‘¥ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</button>
        <button onclick="showSection('transfers')">ğŸ’± Ø§Ù„ØªØ­ÙˆÙŠÙ„Ø§Øª</button>
        <button onclick="showSection('settings')">âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
    </nav>

    <section id="home" class="active">
        <h2>Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</h2>
        <div id="stats" class="card">
            <p>ğŸ’° Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ: <span id="balance">0</span> ï·¼</p>
            <p>ğŸ’µ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹: <span id="incomeTotal">0</span> ï·¼</p>
            <p>ğŸ’¸ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª: <span id="expenseTotal">0</span> ï·¼</p>
            <p>ğŸ“ˆ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª: <span id="salesTotal">0</span> ï·¼</p>
            <p>ğŸ’ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­: <span id="profitTotal">0</span> ï·¼</p>
        </div>
        <div class="card">
            <h3>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø³Ø±ÙŠØ¹Ø©</h3>
            <div class="form-row">
                <button onclick="showSection('customers'); document.getElementById('addCustomerBtn').click();">â• Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙŠÙ„</button>
                <button onclick="showSection('transfers'); document.getElementById('addTransferBtn').click();">ğŸ’± Ø¥Ø¶Ø§ÙØ© ØªØ­ÙˆÙŠÙ„</button>
                <button onclick="addExpense()">ğŸ’¸ Ø¥Ø¶Ø§ÙØ© Ù…ØµØ±ÙˆÙ</button>
            </div>
        </div>
        <button id="resetValues" class="danger">ğŸ”„ ØªØµÙÙŠØ± Ø§Ù„Ù‚ÙŠÙ…</button>
    </section>

    <section id="customers">
        <h2>Ù‚Ø³Ù… Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</h2>
        <div class="card">
            <div class="form-row">
                <input type="text" id="searchCustomer" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¹Ù† Ø¹Ù…ÙŠÙ„..." style="flex: 2;">
                <button id="addCustomerBtn">â• Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙŠÙ„</button>
            </div>
        </div>
        <table id="customerTable">
            <thead>
                <tr>
                    <th>Ø§Ù„Ø§Ø³Ù…</th><th>Ø§Ù„Ù…Ø¨ÙŠØ¹</th><th>Ø§Ù„ØªÙƒÙ„ÙØ©</th><th>Ø§Ù„Ø±Ø¨Ø­</th>
                    <th>Ø§Ù„Ù…Ø³Ø¯Ø¯</th><th>Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ</th><th>Ø§Ù„Ø±ØµÙŠØ¯ Ø¨Ø¹Ø¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©</th><th>âš™ï¸</th>
                </tr>
            </thead>
            <tbody id="customerBody"></tbody>
        </table>
    </section>

    <section id="transfers">
        <h2>Ù‚Ø³Ù… Ø§Ù„ØªØ­ÙˆÙŠÙ„Ø§Øª</h2>
        <div class="card">
            <div class="form-row">
                <button id="addTransferBtn">â• Ø¥Ø¶Ø§ÙØ© ØªØ­ÙˆÙŠÙ„</button>
                <button onclick="filterTransfers('all')" class="secondary">Ø§Ù„ÙƒÙ„</button>
                <button onclick="filterTransfers('income')" class="secondary">Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹Ø§Øª</button>
                <button onclick="filterTransfers('expense')" class="secondary">Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</button>
            </div>
        </div>
        <div id="transfersList"></div>
    </section>

    <section id="settings">
        <h2>Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h2>
        <div class="card">
            <h3>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h3>
            <button id="clearData" class="danger">ğŸ§¹ ØªØµÙÙŠØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
            <button id="exportData" class="secondary">ğŸ“¤ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
            <button id="importData" class="secondary">ğŸ“¥ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
            <input type="file" id="importFile" accept=".json" style="display: none;">
        </div>
        <div class="card">
            <h3>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</h3>
            <p>Ø§Ù„Ø¹Ù…Ù„Ø©: Ø§Ù„Ø±ÙŠØ§Ù„ Ø§Ù„ÙŠÙ…Ù†ÙŠ ğŸ‡¾ğŸ‡ª</p>
            <p>Ø¥ØµØ¯Ø§Ø± Ø§Ù„ØªØ·Ø¨ÙŠÙ‚: 1.1</p>
            <p>Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: Ù¢Ù Ù¢Ù£</p>
        </div>
    </section>

    <div id="customerModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="customerModalTitle">Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙŠÙ„ Ø¬Ø¯ÙŠØ¯</h3>
                <button class="close-modal" onclick="closeModal('customerModal')">&times;</button>
            </div>
            <div class="form-group">
                <input type="text" id="customerName" placeholder="ğŸ‘¤ Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„">
            </div>
            <div class="form-row">
                <input type="number" id="customerSale" placeholder="ğŸ’° Ø§Ù„Ù…Ø¨ÙŠØ¹">
                <input type="number" id="customerCost" placeholder="ğŸ’¸ Ø§Ù„ØªÙƒÙ„ÙØ©">
            </div>
            <div class="form-group">
                <input type="number" id="customerPaid" placeholder="ğŸ’µ Ø§Ù„Ù…Ø³Ø¯Ø¯">
            </div>
            <div class="form-row">
                <button id="saveCustomerBtn">ğŸ’¾ Ø­ÙØ¸</button>
                <button class="secondary" onclick="closeModal('customerModal')">Ø¥Ù„ØºØ§Ø¡</button>
            </div>
        </div>
    </div>

    <div id="transferModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="transferModalTitle">Ø¥Ø¶Ø§ÙØ© ØªØ­ÙˆÙŠÙ„ Ø¬Ø¯ÙŠØ¯</h3>
                <button class="close-modal" onclick="closeModal('transferModal')">&times;</button>
            </div>
            <div class="form-group">
                <input type="text" id="transferDescription" placeholder="ğŸ“ ÙˆØµÙ Ø§Ù„ØªØ­ÙˆÙŠÙ„">
            </div>
            <div class="form-group">
                <select id="transferType">
                    <option value="income">Ø¥ÙŠØ¯Ø§Ø¹</option>
                    <option value="expense">Ù…ØµØ±ÙˆÙ</option>
                </select>
            </div>
            <div class="form-group">
                <input type="number" id="transferAmount" placeholder="ğŸ’µ Ø§Ù„Ù…Ø¨Ù„Øº">
            </div>
            <div class="form-group">
                <input type="date" id="transferDate">
            </div>
            <div class="form-row">
                <button id="saveTransferBtn">ğŸ’¾ Ø­ÙØ¸</button>
                <button class="secondary" onclick="closeModal('transferModal')">Ø¥Ù„ØºØ§Ø¡</button>
            </div>
        </div>
    </div>

    <script>
        // âœ… Ø§Ù„Ø­ÙØ¸ ÙÙŠ LocalStorage
        function saveData(key, value) { localStorage.setItem(key, JSON.stringify(value)); }
        function loadData(key) { const data = localStorage.getItem(key); return data ? JSON.parse(data) : null; }

        // âœ… Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
        function showSection(id) {
            document.querySelectorAll('section').forEach(sec => sec.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            document.querySelectorAll('nav button').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            if (id === 'transfers') renderTransfers();
        }

        // âœ… Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        let balance = loadData("balance") || 0;
        let incomeTotal = loadData("incomeTotal") || 0;
        let expenseTotal = loadData("expenseTotal") || 0;
        let salesTotal = loadData("salesTotal") || 0;
        let profitTotal = loadData("profitTotal") || 0;
        let customers = loadData("customers") || [];
        let transfers = loadData("transfers") || [];

        // âœ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚ÙŠÙ… ÙÙŠ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
        function updateStats() {
            document.getElementById("balance").textContent = balance;
            document.getElementById("incomeTotal").textContent = incomeTotal;
            document.getElementById("expenseTotal").textContent = expenseTotal;
            document.getElementById("salesTotal").textContent = salesTotal;
            document.getElementById("profitTotal").textContent = profitTotal;
            saveData("balance", balance); saveData("incomeTotal", incomeTotal);
            saveData("expenseTotal", expenseTotal); saveData("salesTotal", salesTotal);
            saveData("profitTotal", profitTotal);
        }

        // âœ… ØªØµÙÙŠØ± Ø§Ù„Ù‚ÙŠÙ…
        document.getElementById("resetValues").onclick = function() {
            if (confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØµÙÙŠØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù‚ÙŠÙ…ØŸ")) {
                balance = incomeTotal = expenseTotal = salesTotal = profitTotal = 0;
                updateStats(); alert("âœ… ØªÙ… ØªØµÙÙŠØ± Ø§Ù„Ù‚ÙŠÙ… Ø¨Ù†Ø¬Ø§Ø­");
            }
        };

        // âœ… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡
        function renderCustomers() {
            const tbody = document.getElementById("customerBody");
            tbody.innerHTML = "";
            customers.forEach((c, i) => {
                const row = document.createElement("tr");
                row.innerHTML = `
                    <td>${c.name}</td><td>${c.sale}</td><td>${c.cost}</td><td>${c.profit}</td>
                    <td>${c.paid}</td><td>${c.remaining}</td><td>${c.balanceAfter}</td>
                    <td><button onclick="editCustomer(${i})">âœï¸</button>
                    <button onclick="deleteCustomer(${i})" class="danger">ğŸ—‘ï¸</button></td>
                `;
                tbody.appendChild(row);
            });
            saveData("customers", customers);
        }

        let currentCustomerIndex = null;
        document.getElementById("addCustomerBtn").onclick = function() {
            currentCustomerIndex = null;
            document.getElementById("customerModalTitle").textContent = "Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙŠÙ„ Ø¬Ø¯ÙŠØ¯";
            document.getElementById("customerName").value = "";
            document.getElementById("customerSale").value = "";
            document.getElementById("customerCost").value = "";
            document.getElementById("customerPaid").value = "";
            openModal('customerModal');
        };

        function editCustomer(index) {
            currentCustomerIndex = index;
            const c = customers[index];
            document.getElementById("customerModalTitle").textContent = "ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„";
            document.getElementById("customerName").value = c.name;
            document.getElementById("customerSale").value = c.sale;
            document.getElementById("customerCost").value = c.cost;
            document.getElementById("customerPaid").value = c.paid;
            openModal('customerModal');
        }

        document.getElementById("saveCustomerBtn").onclick = function() {
            const name = document.getElementById("customerName").value.trim();
            if (!name) { alert("âš ï¸ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„"); return; }
            const sale = parseFloat(document.getElementById("customerSale").value) || 0;
            const cost = parseFloat(document.getElementById("customerCost").value) || 0;
            const paid = parseFloat(document.getElementById("customerPaid").value) || 0;
            const profit = sale - cost;
            const remaining = sale - paid;
            const balanceAfter = balance + profit;
            const customerData = { name, sale, cost, profit, paid, remaining, balanceAfter };
            if (currentCustomerIndex === null) {
                customers.push(customerData);
                balance += profit; incomeTotal += paid; salesTotal += sale; profitTotal += profit;
            } else {
                customers[currentCustomerIndex] = customerData;
            }
            updateStats(); renderCustomers(); closeModal('customerModal');
        };

        function deleteCustomer(index) {
            if (confirm("ğŸ—‘ï¸ Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù…ÙŠÙ„ØŸ")) {
                customers.splice(index, 1); renderCustomers();
            }
        }

        document.getElementById("searchCustomer").oninput = function() {
            const value = this.value.trim().toLowerCase();
            const rows = document.querySelectorAll("#customerBody tr");
            rows.forEach(row => {
                const name = row.cells[0].textContent.toLowerCase();
                row.style.display = name.includes(value) ? "" : "none";
            });
        };

        // âœ… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ­ÙˆÙŠÙ„Ø§Øª
        function renderTransfers(filter = 'all') {
            const container = document.getElementById("transfersList");
            container.innerHTML = "";
            let filteredTransfers = transfers;
            if (filter !== 'all') filteredTransfers = transfers.filter(t => t.type === filter);
            if (filteredTransfers.length === 0) {
                container.innerHTML = '<div class="card"><p>Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ­ÙˆÙŠÙ„Ø§Øª Ù„Ø¹Ø±Ø¶Ù‡Ø§</p></div>';
                return;
            }
            filteredTransfers.forEach((transfer, index) => {
                const card = document.createElement("div");
                card.className = "transfer-card";
                card.innerHTML = `
                    <h3>${transfer.description}</h3>
                    <p>Ø§Ù„Ù…Ø¨Ù„Øº: <strong>${transfer.amount} ï·¼</strong></p>
                    <p>Ø§Ù„Ù†ÙˆØ¹: <span style="color: ${transfer.type === 'income' ? '#4CAF50' : '#FF5252'}">${transfer.type === 'income' ? 'Ø¥ÙŠØ¯Ø§Ø¹' : 'Ù…ØµØ±ÙˆÙ'}</span></p>
                    <p>Ø§Ù„ØªØ§Ø±ÙŠØ®: ${transfer.date}</p>
                    <button onclick="deleteTransfer(${index})" class="danger" style="margin-top: 10px;">Ø­Ø°Ù</button>
                `;
                container.appendChild(card);
            });
        }

        document.getElementById("addTransferBtn").onclick = function() {
            document.getElementById("transferModalTitle").textContent = "Ø¥Ø¶Ø§ÙØ© ØªØ­ÙˆÙŠÙ„ Ø¬Ø¯ÙŠØ¯";
            document.getElementById("transferDescription").value = "";
            document.getElementById("transferType").value = "income";
            document.getElementById("transferAmount").value = "";
            document.getElementById("transferDate").valueAsDate = new Date();
            openModal('transferModal');
        };

        document.getElementById("saveTransferBtn").onclick = function() {
            const description = document.getElementById("transferDescription").value.trim();
            const type = document.getElementById("transferType").value;
            const amount = parseFloat(document.getElementById("transferAmount").value) || 0;
            const date = document.getElementById("transferDate").value;
            if (!description) { alert("âš ï¸ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙˆØµÙ Ù„Ù„ØªØ­ÙˆÙŠÙ„"); return; }
            if (amount <= 0) { alert("âš ï¸ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­"); return; }
            const transfer = { description, type, amount, date: date || new Date().toISOString().split('T')[0] };
            transfers.push(transfer);
            if (type === 'income') { balance += amount; incomeTotal += amount; }
            else { balance -= amount; expenseTotal += amount; }
            updateStats(); saveData("transfers", transfers); renderTransfers(); closeModal('transferModal');
        };

        function deleteTransfer(index) {
            if (confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„ØªØ­ÙˆÙŠÙ„ØŸ")) {
                const transfer = transfers[index];
                if (transfer.type === 'income') { balance -= transfer.amount; incomeTotal -= transfer.amount; }
                else { balance += transfer.amount; expenseTotal -= transfer.amount; }
                transfers.splice(index, 1);
                updateStats(); saveData("transfers", transfers); renderTransfers();
            }
        }

        function filterTransfers(type) { renderTransfers(type); }
        function addExpense() {
            const description = prompt("ğŸ’¸ ÙˆØµÙ Ø§Ù„Ù…ØµØ±ÙˆÙ:");
            if (!description) return;
            const amount = parseFloat(prompt("ğŸ’° Ø§Ù„Ù…Ø¨Ù„Øº:"));
            if (!amount || amount <= 0) { alert("âš ï¸ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­"); return; }
            const transfer = { description, type: 'expense', amount, date: new Date().toISOString().split('T')[0] };
            transfers.push(transfer);
            balance -= amount; expenseTotal += amount;
            updateStats(); saveData("transfers", transfers); alert("âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…ØµØ±ÙˆÙ Ø¨Ù†Ø¬Ø§Ø­");
        }

        // âœ… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
        function openModal(modalId) { document.getElementById(modalId).style.display = 'flex'; }
        function closeModal(modalId) { document.getElementById(modalId).style.display = 'none'; }

        // âœ… Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
        document.getElementById("clearData").onclick = function() {
            if (confirm("âš ï¸ Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† ØªØµÙÙŠØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ")) {
                localStorage.clear();
                customers = []; transfers = [];
                balance = incomeTotal = expenseTotal = salesTotal = profitTotal = 0;
                renderCustomers(); renderTransfers(); updateStats();
                alert("ğŸ§¹ ØªÙ… Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­");
            }
        };

        document.getElementById("exportData").onclick = function() {
            const data = { balance, incomeTotal, expenseTotal, salesTotal, profitTotal, customers, transfers, exportDate: new Date().toISOString() };
            const dataStr = JSON.stringify(data, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `abusanad-backup-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
        };

        document.getElementById("importData").onclick = function() { document.getElementById("importFile").click(); };
        document.getElementById("importFile").onchange = function(e) {
            const file = e.target.files[0]; if (!file) return;
            const reader = new FileReader();
            reader.onload = function(event) {
                try {
                    const data = JSON.parse(event.target.result);
                    if (confirm("âš ï¸ Ø³ÙŠØªÙ… Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©. Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©ØŸ")) {
                        balance = data.balance || 0; incomeTotal = data.incomeTotal || 0;
                        expenseTotal = data.expenseTotal || 0; salesTotal = data.salesTotal || 0;
                        profitTotal = data.profitTotal || 0; customers = data.customers || [];
                        transfers = data.transfers || [];
                        updateStats(); renderCustomers(); renderTransfers();
                        saveData("customers", customers); saveData("transfers", transfers);
                        alert("âœ… ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­");
                    }
                } catch (error) { alert("âŒ Ø®Ø·Ø£ ÙÙŠ Ù…Ù„Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­Ø© Ø§Ù„Ù…Ù„Ù"); }
            };
            reader.readAsText(file); e.target.value = '';
        };

        // âœ… Ø£ÙˆÙ„ ØªØ­Ù…ÙŠÙ„
        updateStats(); renderCustomers(); renderTransfers();
    </script>
</body>
</html>
